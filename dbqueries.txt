!--------------------ORDER DATABASE--------------------!

1.
select count(customer_id) 
from customer 
where grade > (select avg(grade) from customer c1 where c1.city="Bangalore");

2.
select s.salesman_id , s.name 
from salesman s , customer c  
where c.salesman_id = s.salesman_id group by s.salesman_id having count(s.salesman_id) > 1;

3.
(select s.salesman_id , s.name , 'Yes' as SameCity from salesman s 
where 0 < (select count(*) from customer c where c.salesman_id = s.salesman_id and c.city=s.city))
 UNION
(select s.salesman_id , s.name , 'No' as SameCity from salesman s 
where 0 = (select count(*) from customer c where c.salesman_id = s.salesman_id and c.city=s.city));

4.
create view maxOrder as
select s.salesman_id , s.name , o.ord_date ,  o.purchase_amount 
from salesman s , orders o 
where s.salesman_id = o.salesman_id
and o.purchase_amount = (select max(purchase_amount) from orders o1 where o1.ord_date = o.ord_date);

5.
DELETE


!--------------------MOVIE DATABASE--------------------!

1.
select m.mov_title 
from movies m , director d 
where m.dir_id = d.dir_id and d.dir_name="Akshat";

2.
select distinct(m.mov_title) 
from movies m , movie_cast mc 
where mc.mov_id=m.mov_id and mc.act_id in 
(select act_id from movie_cast group by act_id having count(act_id)>1);

3.
select a.act_name 
from actor a 
join movie_cast mc on mc.act_id=a.act_id 
join movies m on m.mov_id = mc.mov_id 
where (exists (select * from movie_cast mc1, movies m1 where a.act_id=mc1.act_id and m1.mov_id=mc1.mov_id and m1.mov_year<2000))
and (exists (select * from movie_cast mc2, movies m2 where a.act_id=mc2.act_id and m2.mov_id=mc2.mov_id and m2.mov_year>2015));

4.
select m.mov_title , count(m.mov_title) as RatingsRecieved , max(rev_stars) 
from movies m inner join rating using (mov_id) 
group by mov_title having max(rev_stars)>0 order by m.mov_title;

5.
update rating 
set rev_stars = 5
where mov_id in
(select mov_id from movies where dir_id in (select dir_id from director where dir_name="Akshat"));
